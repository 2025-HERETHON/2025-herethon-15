{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>어떤 증상인가요?</title>
</head>
<body>
  <!-- 증상 입력 및 선택 영역 -->
  <h2>어떤 증상인가요?</h2>
  <form method="POST" action="{% url 'accounts:symptom_search' %}">
    {% csrf_token %}
    <input type="text" name="symptom" id="symptom" placeholder="증상을 선택 및 입력해 주세요" value="{{ symptom|default_if_none:'' }}"><br>
    
    <b>직접 입력</b>
    <!-- 증상 리스트 -->
    <div id="symptom-list">
      {% for category, symptoms in categorized_symptoms.items %}
        <div class="category">
          <div class="category-title"><b>{{ category }}</b><div>
          {% for symptom in symptoms|slice:":2" %}
            <div class="symptom-item" onclick="selectSymptom('{{ symptom }}')">
              {{ symptom }}
            </div>
          {% endfor %}
        </div>
      {% endfor %}
    </div>
    <div id="symptom-list-container" style="display: none;"></div>
    <button type="submit">진료과 조회하기</button>
  </form>


  <!-- POST 요청 시 추천 진료과 출력-->
  {% if specialties %}
    <div>
      <h3>추천 진료과</h3>
      <ul>
        {% for s in specialties %}
          <li>{{ s.name }}</li>
        {% endfor %}
      </ul>
      <form method="GET" action="{% url 'accounts:symptom_search' %}">
        <input type="hidden" name="specialties" value="{{ specialties|join:',' }}">
        <button type="submit">병원 찾기</button>
      </form>
    </div>
  {% elif not_found %}
    <p>해당 증상에 대한 추천 진료과가 없습니다.</p>
  {% endif %}

  <script>
    function selectSymptom(symptom) {
      document.getElementById('symptom').value = symptom;
    }
    </script>
</body>
</html>
